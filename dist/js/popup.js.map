{"version":3,"file":"js/popup.js","mappings":";;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACJA;AACA;AACA;;;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACHA;AACA;AACA;;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AC1BA;AACA;AACA;;;;;;;;;;;;;;;ACFA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;AAoFA;AACA;AACA;AACA;AACA;AAJA;AAAA;AApFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AACA;AAAA;AAAA;AAEA;AACA;AAGA;AACA;AACA;AACA;;AAEA;AACA;AAGA;AAGA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AACA;AAAA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;AAEA;AACA;AAAA;AACA;AAAA;AAAA;AAGA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAOA;AACA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;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AAGA;AAAA;AAEA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AAAA;AAGA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AAAA;AAGA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAGA;AACA;AAGA;AACA;AACA;AAEA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAjCA;AAAA;AAAA;AAAA;AAkCA;;;;;;ACxWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACRA;AACA;AACA;AACA;AACA;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACPA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AErFA;AACA;AACA;AACA;AACA","sources":["webpack://chrome_extension/./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://chrome_extension/./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://chrome_extension/./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack://chrome_extension/./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack://chrome_extension/./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://chrome_extension/./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://chrome_extension/./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack://chrome_extension/./node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://chrome_extension/./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack://chrome_extension/./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack://chrome_extension/./src/js/pdfUtils.js","webpack://chrome_extension/./src/js/popup.js","webpack://chrome_extension/webpack/bootstrap","webpack://chrome_extension/webpack/runtime/chunk loaded","webpack://chrome_extension/webpack/runtime/compat get default export","webpack://chrome_extension/webpack/runtime/create fake namespace object","webpack://chrome_extension/webpack/runtime/define property getters","webpack://chrome_extension/webpack/runtime/ensure chunk","webpack://chrome_extension/webpack/runtime/get javascript chunk filename","webpack://chrome_extension/webpack/runtime/global","webpack://chrome_extension/webpack/runtime/hasOwnProperty shorthand","webpack://chrome_extension/webpack/runtime/load script","webpack://chrome_extension/webpack/runtime/make namespace object","webpack://chrome_extension/webpack/runtime/publicPath","webpack://chrome_extension/webpack/runtime/jsonp chunk loading","webpack://chrome_extension/webpack/before-startup","webpack://chrome_extension/webpack/startup","webpack://chrome_extension/webpack/after-startup"],"sourcesContent":["function _arrayLikeToArray(r, a) {\n  (null == a || a > r.length) && (a = r.length);\n  for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e];\n  return n;\n}\nexport { _arrayLikeToArray as default };","function _arrayWithHoles(r) {\n  if (Array.isArray(r)) return r;\n}\nexport { _arrayWithHoles as default };","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nfunction _arrayWithoutHoles(r) {\n  if (Array.isArray(r)) return arrayLikeToArray(r);\n}\nexport { _arrayWithoutHoles as default };","function _iterableToArray(r) {\n  if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r);\n}\nexport { _iterableToArray as default };","function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nexport { _iterableToArrayLimit as default };","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nexport { _nonIterableRest as default };","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nexport { _nonIterableSpread as default };","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nfunction _slicedToArray(r, e) {\n  return arrayWithHoles(r) || iterableToArrayLimit(r, e) || unsupportedIterableToArray(r, e) || nonIterableRest();\n}\nexport { _slicedToArray as default };","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nfunction _toConsumableArray(r) {\n  return arrayWithoutHoles(r) || iterableToArray(r) || unsupportedIterableToArray(r) || nonIterableSpread();\n}\nexport { _toConsumableArray as default };","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nfunction _unsupportedIterableToArray(r, a) {\n  if (r) {\n    if (\"string\" == typeof r) return arrayLikeToArray(r, a);\n    var t = {}.toString.call(r).slice(8, -1);\n    return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? arrayLikeToArray(r, a) : void 0;\n  }\n}\nexport { _unsupportedIterableToArray as default };","/**\n * Generates a professional PDF document from text content\n * @param {string} text - The content to convert to PDF\n * @param {string} [filename=\"document.pdf\"] - Output filename\n * @returns {Promise<boolean>} - True if successful, false if failed\n */\nexport async function downloadAsPDF(text, filename = \"document.pdf\") {\n    // Validate input\n    if (!text || typeof text !== 'string') {\n        showErrorNotification('Invalid content for PDF generation');\n        return false;\n    }\n\n    try {\n        // Configuration constants\n        const DOC_CONFIG = {\n            orientation: 'portrait',\n            unit: 'mm',\n            format: 'a4',\n            margins: {\n                top: 15,\n                right: 15,\n                bottom: 25,\n                left: 15\n            }\n        };\n\n        const TYPOGRAPHY = {\n            font: 'helvetica',\n            style: 'normal',\n            size: 11,\n            color: [40, 40, 40],\n            lineHeight: 7,\n            paragraphSpacing: 4\n        };\n\n        // Dynamically import jsPDF\n        const { jsPDF } = await import('jspdf');\n        \n        // Initialize document\n        const doc = new jsPDF(DOC_CONFIG);\n\n        // Apply typography settings\n        doc.setFont(TYPOGRAPHY.font, TYPOGRAPHY.style);\n        doc.setFontSize(TYPOGRAPHY.size);\n        doc.setTextColor(...TYPOGRAPHY.color);\n        doc.setLineHeightFactor(1.5);\n\n        // Calculate available width\n        const maxWidth = doc.internal.pageSize.getWidth() - \n                        (DOC_CONFIG.margins.left + DOC_CONFIG.margins.right);\n        \n        let yPos = DOC_CONFIG.margins.top;\n\n        // Process content\n        const paragraphs = text.split('\\n')\n                              .filter(p => p.trim().length > 0)\n                              .map(p => p.trim());\n\n        for (const paragraph of paragraphs) {\n            const lines = doc.splitTextToSize(paragraph, maxWidth);\n            \n            for (const line of lines) {\n                // Check for page break\n                if (yPos > doc.internal.pageSize.getHeight() - DOC_CONFIG.margins.bottom) {\n                    doc.addPage();\n                    yPos = DOC_CONFIG.margins.top;\n                }\n                \n                doc.text(line, DOC_CONFIG.margins.left, yPos);\n                yPos += TYPOGRAPHY.lineHeight;\n            }\n            \n            yPos += TYPOGRAPHY.paragraphSpacing;\n        }\n\n        // Add professional footer\n        addDocumentFooter(doc, DOC_CONFIG.margins.left);\n        \n        // Save PDF\n        doc.save(filename);\n        return true;\n        \n    } catch (error) {\n        console.error('PDF generation error:', error);\n        showErrorNotification(`PDF generation failed: ${error.message}`);\n        return false;\n    }\n}\n\n/**\n * Adds a professional footer to the document\n * @param {jsPDF} doc - The PDF document instance\n * @param {number} margin - Left margin position\n */\nfunction addDocumentFooter(doc, margin) {\n    const footerConfig = {\n        text: `Generated on ${new Date().toLocaleDateString()}`,\n        fontSize: 9,\n        color: [100, 100, 100],\n        position: doc.internal.pageSize.getHeight() - 10\n    };\n\n    doc.setFontSize(footerConfig.fontSize);\n    doc.setTextColor(...footerConfig.color);\n    doc.text(footerConfig.text, margin, footerConfig.position);\n}\n\n/**\n * Displays error notification to user\n * @param {string} message - Error message to display\n */\nfunction showErrorNotification(message) {\n    try {\n        if (typeof chrome !== 'undefined' && chrome.notifications) {\n            chrome.notifications.create({\n                type: 'basic',\n                iconUrl: 'icons/icon48.png',\n                title: 'PDF Export Error',\n                message: message.substring(0, 150) // Limit message length\n            });\n        } else {\n            alert(message.substring(0, 500)); // Fallback with longer message\n        }\n    } catch (err) {\n        console.error('Error notification failed:', err);\n    }\n}","import { downloadAsPDF } from './pdfUtils.js';\n\n\nlet isDownloading = false;\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    // DOM Elements\n    const result = document.getElementById('result');\n    const statusMessage = document.getElementById('statusMessage');\n    const quizBtn = document.getElementById(\"quizBtn\");\n    const citationBtn = document.getElementById(\"citationBtn\");\n    const voiceBtn = document.getElementById(\"voiceBtn\");\n    const relatedBtn = document.getElementById(\"relatedBtn\");\n    const summarizeBtn = document.getElementById('summarizeBtn');\n    const saveBtn = document.getElementById(\"saveBtn\");\n    \n    // Early exit if required elements missing\n    if (!result || !summarizeBtn || !statusMessage) {  \n        console.error(\"Critical Error: Required elements not found\");\n        return;\n    }\n\n    // Content formatter\n    function formatContent(content, type = 'summary') {\n        return `\n            <div class=\"content-${type}\">\n                ${content\n                    .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n                    .replace(/\\*(.*?)\\:/g, '<strong>$1:</strong>')\n                    .replace(/\\* /g, '• ')\n                    .replace(/\\n/g, '<br>')}\n            </div>\n        `;\n    }\n\n    // Related content formatter\n    function formatRelatedContent(content) {\n        return `\n            <div class=\"related-content\">\n                <h2>Related Content</h2>\n                <ul class=\"related-list\">\n                    ${content\n                        .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n                        .replace(/\\*(.*?)\\:/g, '<h3>$1</h3>')\n                        .replace(/\\* /g, '<li>')\n                        .replace(/\\n/g, '<br>')\n                        .replace(/(<li>.*?)(<br>|$)/g, '$1</li>$2')}\n                </ul>\n            </div>\n        `;\n    }\n\n    // Status message handler\n    function showStatus(message, type) {\n        if (!statusMessage) return;\n        \n        statusMessage.textContent = message;\n        statusMessage.className = `status-message ${type}`;\n        statusMessage.style.display = 'block';\n        statusMessage.style.opacity = '1';\n        \n        setTimeout(() => {\n            statusMessage.style.opacity = '0';\n            setTimeout(() => statusMessage.style.display = 'none', 500);\n        }, 5000);\n    }\n\n    // Text extraction function\n    async function extractingText(buttonType = 'summary') {\n        try {\n            // Cancel any ongoing speech\n            if (window.speechSynthesis) {\n                window.speechSynthesis.cancel();\n            }\n\n            // Show loading state\n            const loadingMessages = {\n                'summary': \"Extracting text for summary...\",\n                'quiz': \"Preparing text for quiz...\",\n                'citation': \"Collecting text for citations...\",\n                'voice': \"Processing text for voice...\",\n                'graph': \"Analyzing text for graph...\",\n                'related': \"Examining text for relations...\"\n            };\n            result.innerHTML = `<div class=\"loading\">${loadingMessages[buttonType] || \"Processing text...\"}</div>`;\n\n            // Get stored settings\n            const { apiKey, knowledgeLevel = 'undergrad' } = await new Promise(resolve => {\n                chrome.storage.sync.get(['apiKey', 'knowledgeLevel'], resolve);\n            });\n\n            if (!apiKey) {\n                showStatus('API key required', 'error');\n                result.innerHTML = '<div class=\"error\">Please configure your API key in settings</div>';\n\n                return { text: null, apiKey: null, knowledgeLevel: null };\n            }\n\n            // Get active tab content\n            const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });\n            if (!tab) {\n                throw new Error(\"No active tab found\");\n            }\n\n            // Extract page content\n            const injectionResults = await chrome.scripting.executeScript({\n                target: { tabId: tab.id },\n                func: () => {\n                    const selectors = ['article', '.post-content', '.article-content', 'main'];\n                    const contentEl = selectors.map(s => document.querySelector(s)).find(el => el) || document.body;\n                    return contentEl.innerText.replace(/\\s+/g, ' ').trim();\n                }\n            });\n\n            const text = injectionResults[0]?.result;\n            if (!text) {\n                throw new Error(\"No extractable text found\");\n            }\n\n            // Show generation status\n            const knowledgeLabels = {\n                'child': 'for children',\n                'teen': 'for teens',\n                'undergrad': 'for undergrads',\n                'graduate': 'for grad students',\n                'phd': 'for experts'\n            };\n            \n            result.innerHTML = `\n                <div class=\"generating\">\n                    ${loadingMessages[buttonType] || \"Generating content\"} \n                    ${knowledgeLabels[knowledgeLevel] || ''}\n                </div>\n            `;\n\n            return { text, apiKey, knowledgeLevel, buttonType };\n\n        } catch (error) {\n            console.error(\"Extraction error:\", error);\n            result.innerHTML = `<div class=\"error\">${error.message}</div>`;\n            return { text: null, apiKey: null, knowledgeLevel: null };\n        }\n    }\n\n    // Gemini API caller\n    async function getSummaryGemini(text, apiKey, prompt, model=\"gemini-2.0-flash\") {\n        try {\n            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent`;\n            \n            const response = await fetch(`${apiUrl}?key=${apiKey}`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    contents: [{\n                        parts: [{ text: `${prompt}\\n\\n${text.substring(0, 30000)}` }]\n                    }]\n                })\n            });\n\n            if (!response.ok) {\n                const errorData = await response.json().catch(() => ({}));\n                throw new Error(errorData.error?.message || `API Error ${response.status}`);\n            }\n\n            const data = await response.json();\n            return data.candidates?.[0]?.content?.parts?.[0]?.text || \"No content generated\";\n\n        } catch (error) {\n            console.error(\"API Error:\", error);\n            throw new Error(`Failed to get response: ${error.message}`);\n        }\n    }\n\n    async function getSummaryDeepSeek(text, apiKey, prompt, model = 'deepseek-chat') {\n        try {\n            const apiUrl = 'https://api.deepseek.com/v1/chat/completions';\n            \n            const response = await fetch(apiUrl, {\n                method: 'POST',\n                headers: { \n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${apiKey}` \n                },\n                body: JSON.stringify({\n                    model: model,\n                    messages: [\n                        { role: \"system\", content: \"You are a helpful assistant.\" },\n                        { role: \"user\", content: `${prompt}\\n\\n${text.substring(0, 30000)}` }\n                    ],\n                    stream: false\n                })\n            });\n    \n            if (!response.ok) {\n                const errorData = await response.json().catch(() => ({}));\n                throw new Error(errorData.error?.message || `API Error ${response.status}`);\n            }\n    \n            const data = await response.json();\n            return data.choices?.[0]?.message?.content || \"No content generated\";\n    \n        } catch (error) {\n            console.error(\"DeepSeek API Error:\", error);\n            throw new Error(`Failed to get response: ${error.message}`);\n        }\n    }\n\n\n    // Text-to-speech handler\n    async function speakText(text) {\n        if (!window.speechSynthesis) {\n            throw new Error(\"Speech synthesis not supported\");\n        }\n\n        return new Promise((resolve, reject) => {\n            const voicesReady = () => {\n                const voices = speechSynthesis.getVoices();\n                if (voices.length === 0) {\n                    reject(new Error(\"No voices available\"));\n                    return;\n                }\n\n                const utterance = new SpeechSynthesisUtterance(text.substring(0, 300));\n                utterance.voice = voices.find(v => v.name.includes('Google')) || voices[0];\n                utterance.rate = 0.95;\n                utterance.pitch = 1.1;\n                utterance.volume = 0.9;\n                utterance.onend = resolve;\n                utterance.onerror = reject;\n\n                speechSynthesis.speak(utterance);\n            };\n\n            // Handle voice loading\n            const voices = speechSynthesis.getVoices();\n            if (voices.length) {\n                voicesReady();\n            } else {\n                speechSynthesis.onvoiceschanged = voicesReady;\n            }\n        });\n    }\n\n    // Button Handlers\n    quizBtn?.addEventListener(\"click\", async () => {\n        try {\n            const { text, apiKey, knowledgeLevel } = await extractingText('quiz');\n            if (!text || !apiKey) return;\n    \n            const prompt = `Create 5 quiz questions (with 4 options each, mark correct answer) \n            at ${knowledgeLevel} level about this text:`;\n            \n            const quizContent = await getSummaryGemini(text, apiKey, prompt);\n            result.innerHTML = formatContent(quizContent, 'quiz');\n        } catch (error) {\n            result.innerHTML = `<div class=\"error\">Quiz Error: ${error.message}</div>`;\n        }\n    });\n\n    citationBtn?.addEventListener(\"click\", async () => {\n        try {\n            const { text, apiKey, buttonType, knowledgeLevel } = await extractingText('citation');\n            if (!text) return;\n\n            const prompt = `Generate ${knowledgeLevel}-level citations in APA, MLA and Chicago styles.\n            ${knowledgeLevel === 'child' ? 'Use simple explanations:' : 'Include technical details:'}`;\n            \n            const citations = await getSummaryGemini(text, apiKey, prompt);\n            result.innerHTML = formatContent(citations, 'citation');\n        } catch (error) {\n            result.innerHTML = `<div class=\"error\">Citation Error: ${error.message}</div>`;\n        }\n    });\n\n    relatedBtn?.addEventListener(\"click\", async () => {\n        try {\n            const { text, apiKey, knowledgeLevel } = await extractingText('related');\n            if (!text) return;\n\n            const prompt = `Suggest 3-5 ${knowledgeLevel}-appropriate related topics with:\n            • Clear titles\n            • Connection explanations\n            • ${knowledgeLevel === 'phd' ? 'Academic references' : 'Simple examples'}`;\n            \n            const related = await getSummaryGemini(text, apiKey, prompt);\n            result.innerHTML = formatRelatedContent(related);\n        } catch (error) {\n            result.innerHTML = `<div class=\"error\">Related Error: ${error.message}</div>`;\n        }\n    });\n\n    voiceBtn?.addEventListener(\"click\", async () => {\n        try {\n            const { text, apiKey, knowledgeLevel } = await extractingText('voice');\n            if (!text) return;\n\n            const prompt = `Create a ${knowledgeLevel}-level spoken summary with:\n            - Conversational tone\n            - ${knowledgeLevel === 'child' ? 'Simple words' : 'Appropriate terminology'}\n            - Clear structure`;\n            \n            const summary = await getSummaryGemini(text, apiKey, prompt);\n            await speakText(summary);\n            result.textContent = \"Speaking...\";\n        } catch (error) {\n            result.innerHTML = `<div class=\"error\">Voice Error: ${error.message}</div>`;\n        }\n    });\n\n    summarizeBtn?.addEventListener('click', async () => {\n        try {\n            const { text, apiKey, knowledgeLevel } = await extractingText('summary');\n            if (!text || !apiKey) return;\n            \n            const prompt = `Provide ${knowledgeLevel}-level summary with:\n            - 5-10 key points\n            - ${knowledgeLevel === 'phd' ? 'Technical depth' : 'Simple language'}\n            - Bullet format`;\n            \n            const summary = await getSummaryGemini(text, apiKey, prompt);\n            result.innerHTML = formatContent(summary, 'summary');\n        } catch (error) {\n            result.innerHTML = `<div class=\"error\">Summary Error: ${error.message}</div>`;\n        }\n    });\n\n    saveBtn?.addEventListener(\"click\", async function handleSave() {\n        if (isDownloading) return;\n        isDownloading = true;\n        \n        try {\n            // Get the current result content\n            const resultContent = document.getElementById('result').innerHTML;\n            \n            // Create a temporary div to extract clean text from HTML\n            const tempDiv = document.createElement('div');\n            tempDiv.innerHTML = resultContent;\n            const cleanText = tempDiv.textContent || tempDiv.innerText || '';\n            \n            // Download as PDF\n            const success = await downloadAsPDF(cleanText, 'summary.pdf');\n            \n            if (!success) {\n                showStatus('PDF generation failed', 'error');\n            } else {\n                showStatus('PDF saved successfully', 'success');\n                // Send message AFTER successful download\n                chrome.runtime.sendMessage({ \n                    type: \"save_summary\",\n                    content: cleanText \n                });\n            }\n            \n        } catch (error) {\n            console.error('Save error:', error);\n            showStatus('Save failed: ' + error.message, 'error');\n        } finally {\n            isDownloading = false;\n        }\n    });\n});\n\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"js/\" + chunkId + \".js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var inProgress = {};\nvar dataWebpackPrefix = \"chrome_extension:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl + \"../\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t\"popup\": 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkchrome_extension\"] = self[\"webpackChunkchrome_extension\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [\"vendors-node_modules_babel_runtime_regenerator_index_js-node_modules_babel_runtime_helpers_es-58772e\"], () => (__webpack_require__(\"./src/js/popup.js\")))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n",""],"names":[],"sourceRoot":""}